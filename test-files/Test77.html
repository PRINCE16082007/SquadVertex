<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Admin â€“ SquadVertex Video Control</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; max-width: 500px; margin: auto; }
    button { display: block; width: 100%; margin: .5rem 0; padding: .5rem; }
    input { display: block; width: 100%; margin: .5rem 0; padding: .5rem; }
  </style>
  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
</head>
<body>
  <h1>ðŸŽ® Admin Panel</h1>

  <!-- 1) Google Sign-in button -->
  <div id="login">
    <button id="btnGoogle">Sign in with Google</button>
  </div>

  <!-- 2) Controls shown only after sign-in -->
  <div id="controls" style="display:none;">
    <h2>Set Active Video</h2>
    <input id="videoId" placeholder="Enter Wistia Video ID">
    <button id="btnSet">Update Live Stream</button>
    <p>Currently Live: <strong><span id="current">â€“</span></strong></p>
  </div>

  <script>
    // â”€â”€ Initialize Firebase â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      // Firebase initialization
  const firebaseConfig = {
    apiKey: "AIzaSyBV7Jg0BVzeCNQW9oiIiNItnejUsjj2DhA",
    authDomain: "squadvertex2007.firebaseapp.com",
    projectId: "squadvertex2007",
    storageBucket: "squadvertex2007.appspot.com",
    messagingSenderId: "168905083514",
    appId: "1:168905083514:web:c8bbe2ce9f87800a0f09c3",
  };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db   = firebase.firestore();

    // References
    const EVENT_ID    = 'SpringLaunch2025';
    const eventRef    = db.collection('events').doc(EVENT_ID);
    const settingsRef = eventRef.collection('settings').doc('activeVideo');

    // â”€â”€ 1) Sign in with Google â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    document.getElementById('btnGoogle').onclick = () => {
      const provider = new firebase.auth.GoogleAuthProvider();
      auth.signInWithPopup(provider)
        .then(result => {
          const user = result.user;
          // Optional: restrict to specific emails
          const allowed = ['gahlotmanan0@gmail.com'];
          if (!allowed.includes(user.email)) {
            alert('You are not an admin.');
            auth.signOut();
            return;
          }
          // Show controls
          document.getElementById('login').style.display    = 'none';
          document.getElementById('controls').style.display = 'block';
          loadCurrent();
        })
        .catch(err => alert('Auth failed: ' + err.message));
    };

    // â”€â”€ 2) Load current activeVideo â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function loadCurrent() {
      settingsRef.onSnapshot(doc => {
        document.getElementById('current').innerText = doc.data()?.videoId || 'None';
      });
    }

    // â”€â”€ 3) Update activeVideo â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    document.getElementById('btnSet').onclick = () => {
      const vid = document.getElementById('videoId').value.trim();
      if (!vid) return alert('Enter a Wistia Video ID');
      settingsRef.set({ videoId: vid, setAt: Date.now() })
        .then(() => alert('Live video updated!'))
        .catch(err => alert('Error: ' + err.message));
    };
  </script>
</body>
</html>