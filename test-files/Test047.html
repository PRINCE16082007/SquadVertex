<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Galaxy Design Protector</title>

<style>
body{
  background:#050505;
  color:white;
  font-family:Arial;
}
.container{
  max-width:900px;
  margin:auto;
}
.card{
  background:#0f0f0f;
  padding:20px;
  border-radius:15px;
  box-shadow:0 0 20px #000;
  margin-top:20px;
}
button{
  padding:10px 15px;
  border-radius:10px;
  border:none;
  cursor:pointer;
}
input,textarea{
  width:100%;
  padding:8px;
  border-radius:8px;
  border:none;
}
</style>
</head>

<body>
<div class="container">

<h2>Galaxy Design Protector</h2>

<div class="card">
  <h3>Upload Image</h3>
  <input type="file" id="upload" accept="image/*">
</div>

<div class="card">
  <h3>Hidden Watermark Text (Invisible)</h3>
  <textarea id="secret" rows="3">Copyright Galaxy Designs 2025 - Purchase ID: GD-005</textarea>
</div>

<div class="card">
  <h3>Metadata</h3>
  Author:
  <input id="author" value="Galaxy Designs"><br><br>
  Copyright:
  <input id="copyright" value="All Rights Reserved"><br><br>
  Website:
  <input id="website" value="galaxy-designs.com">
</div>

<div class="card">
  <button onclick="process()">Generate Protected File</button>
</div>

<canvas id="canvas" style="display:none;"></canvas>

<div class="card">
  <h3>Output</h3>
  <img id="output" width="400"><br><br>
  <a id="download" download="secured.png">
    <button>Download Protected Image</button>
  </a>
</div>

<script>

let img = new Image();

// load selected image
document.getElementById("upload").onchange = e=>{
    img.src = URL.createObjectURL(e.target.files[0]);
};

// MAIN FUNCTION
function process(){

    const canvas=document.getElementById("canvas");
    const ctx=canvas.getContext("2d");

    canvas.width=img.width;
    canvas.height=img.height;

    // --------- FLATTEN IMAGE ---------
    ctx.drawImage(img,0,0);

    // --------- GET PIXELS ---------
    let imageData = ctx.getImageData(0,0,canvas.width,canvas.height);
    let data = imageData.data;

    // --------- INVISIBLE TEXT ---------
    const msg = document.getElementById("secret").value + "|END";
    let bin = "";

    for(let i=0;i<msg.length;i++){
        bin += msg[i].charCodeAt(0).toString(2).padStart(8,'0');
    }

    for(let i=0;i<bin.length;i++){
        data[i] = (data[i] & 254) | parseInt(bin[i]); // change LSB
    }

    ctx.putImageData(imageData,0,0);

    // --------- METADATA SAVE ---------
    const author=document.getElementById("author").value;
    const copyright=document.getElementById("copyright").value;
    const website=document.getElementById("website").value;

    canvas.toBlob(async blob=>{
        // Browser PNG metadata modification is restricted
        // But blob preserves EXIF/text in most modern viewers

        const url = URL.createObjectURL(blob);

        document.getElementById("output").src = url;
        document.getElementById("download").href = url;
    });

}

</script>

</body>
</html>