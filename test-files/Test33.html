<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>GalaxyWeb Functional</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
<style>
  /* Include all your CSS here (use the CSS you provided) */
  body {
    background: #181f2b;
    color: #fff;
    margin: 0;
    font-family: Arial, sans-serif;
  }
  .top-bar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 100px;
    background: #232e40;
    padding: 0 30px;
  }
  .logo-title {
    display: flex;
    align-items: center;
    gap: 15px;
    font-size: 2rem;
    font-weight: bold;
  }
  .nav-buttons {
    display: flex;
    align-items: center;
    gap: 30px;
    font-size: 1.2rem;
    position: relative;
  }
  .nav-btn, .profile-btn {
    background: none;
    border: none;
    color: #fff;
    cursor: pointer;
    font-size: 1.1rem;
    position: relative;
  }
  .nav-btn:hover, .profile-btn:hover {
    text-decoration: underline;
  }
  .dropdown-content {
    display: none;
    position: absolute;
    right: 0;
    background: #1d2336;
    min-width: 120px;
    border-radius: 7px;
    box-shadow: 0 5px 22px #232e4088;
    top: 40px;
    z-index: 1000;
  }
  .dropdown-content a {
    color: #fff;
    padding: 10px 14px;
    text-decoration: none;
    display: block;
    border-bottom: 1px solid #343654;
  }
  .dropdown-content a:last-child {
    border-bottom: none;
  }
  .nav-buttons .more-options:hover .dropdown-content,
  .nav-buttons .profile-btn.show-menu + .dropdown-content {
    display: block;
  }
  /* Banner */
  .banner {
    height: 539px;
    background: #222739;
    margin: 0;
    padding: 0;
  }
  .banner img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }
  /* Description */
  .desc-section {
    height: 433px;
    background: #1c2236;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 36px;
  }
  .desc-text {
    flex: 2;
    display: flex;
    flex-direction: column;
    justify-content: center;
    text-align: left;
    gap: 32px;
  }
  .desc-text h1 {
    font-size: 2.2rem;
  }
  .desc-text p {
    font-size: 1.3rem;
    max-width: 560px;
    white-space: pre-line;
  }
  .desc-img {
    flex: 1;
    display: flex;
    justify-content: flex-end;
    align-items: center;
    height: 100%;
  }
  .desc-img img {
    max-width: 85%;
    max-height: 370px;
    border-radius: 18px;
    background: #283050;
    object-fit: contain;
    border: 2px solid #344261;
  }
  /* Cards */
  .cards-section {
    display: flex;
    gap: 32px;
    justify-content: center;
    align-items: stretch;
    background-image: url('https://dl.dropboxusercontent.com/scl/fi/702xkjz07yxrq8mr6trzx/192f66_590271f07f9c499c92f0912416c55cbe-mv2.png?rlkey=0vnahm1klu5qf4da6gzmwzmjg&st=pkbwfnoo&dl=0');
    background-size: cover;
    background-position: center;
    width: 100vw;
    height: 500px;
    padding: 0 40px;
    overflow-x: hidden;
  }
  .card {
    background: rgba(24,31,43,0.85);
    border-radius: 16px;
    margin: 20px 10px;
    min-width: 240px;
    height: 95%;
    display: flex;
    flex-direction: column;
    color: #fff;
    overflow: hidden;
    cursor: pointer;
  }
  .card img {
    height: 100px;
    width: 100%;
    object-fit: cover;
    border-top-left-radius: 16px;
    border-top-right-radius: 16px;
    margin-bottom: 12px;
  }
  .card-content {
    padding: 18px;
    flex-grow: 1;
    text-align: center;
  }
  .card-content h3 {
    margin: 0 0 10px 0;
  }
  .card-content p {
    font-size: 1rem;
    white-space: pre-line;
  }
  .card-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 1rem;
    opacity: 0.92;
    padding: 0 18px 12px 18px;
  }
  .card-footer .views,
  .card-footer .likes {
    display: flex;
    align-items: center;
    gap: 7px;
  }
  .card-footer .likes {
    cursor: pointer;
  }
  /* Collaborators */
  .collaborators-wrap {
    background: #252d42;
    padding: 32px 60px;
    min-height: 260px;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    justify-content: flex-start;
  }
  .collaborators-title {
    font-size: 1.8rem;
    color: #fab84f;
    margin-bottom: 22px;
    font-weight: 600;
    letter-spacing: 1px;
  }
  .collaborators-section {
    width: 100%;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 32px;
    justify-items: center;
    align-items: center;
    margin-top: 10px;
  }
  .collaborator-logo-box {
    background: linear-gradient(135deg, #192135 55%, #2e3c5c);
    box-shadow: 0 0 18px #171d2c55;
    border-radius: 26px;
    width: 120px;
    height: 120px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 16px;
    transition: box-shadow 0.2s;
    border: 2px solid #e9c46a;
  }
  .collaborator-logo-box:hover {
    box-shadow: 0 0 22px #fab84f;
  }
  .collaborator-logo-box img {
    width: 90px;
    height: 90px;
    object-fit: contain;
    border-radius: 14px;
    background: #243049;
    margin-bottom: 7px;
  }
  .collaborator-label {
    font-size: 0.96rem;
    color: #fff;
    text-align: center;
    margin-top: 2px;
    white-space: nowrap;
  }
  /* Footer */
  .footer {
    min-height: 300px;
    background: linear-gradient(90deg, #181f2b 60%, #232e44 100%);
    color: #fff;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    align-items: center;
    padding-top: 40px;
    padding-bottom: 24px;
    gap: 18px;
    font-size: 1.1rem;
    letter-spacing: 1px;
    border-top: 2px solid #163053;
  }
  .footer-links {
    display: flex;
    gap: 44px;
  }
  .footer-links a {
    color: #fff;
    font-size: 2.1rem;
    text-decoration: none;
    padding: 0 4px;
    transition: color 0.2s;
  }
  .footer-links a:hover {
    color: #fab84f;
  }
  .footer-legal {
    margin-top: 16px;
    display: flex;
    gap: 38px;
    font-size: 1rem;
    color: #aaa;
  }
  .footer-legal a {
    color: #aaa;
    text-decoration: none;
    font-weight: 600;
  }
  .footer-legal a:hover {
    text-decoration: underline;
  }
  .support-email {
    font-size: 1.15rem;
    color: #6cdbf7;
    margin-top: 12px;
    letter-spacing: 2px;
    user-select: text;
  }
</style>
<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-check-compat.js"></script>
<!-- reCaptcha -->
<script src="https://www.google.com/recaptcha/api.js?render=6Ld395IrAAAAAIvG4gyf0vUJeI_jKOsI9XVn0jUx"></script>
</head>
<body>
  <!-- Top Section -->
  <div class="top-bar">
    <div class="logo-title">
      <img
        src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a7/React-icon.svg/120px-React-icon.svg.png"
        height="46"
        alt="Logo"
      />
      GalaxyWeb
    </div>
    <div class="nav-buttons">
      <button class="nav-btn">uw gzbskzj</button>
      <button class="nav-btn">haosjj whhaj</button>
      <div class="more-options">
        <button class="nav-btn">wnus hcs ▼</button>
        <div class="dropdown-content">
          <a href="#">hx w</a>
          <a href="#">hg na</a>
          <a href="#">kzj lk</a>
        </div>
      </div>
      <button id="profileBtn" class="profile"><i class="fa-solid fa-user"></i></button>
      <div id="profileMenu" class="dropdown-content" style="right: 30px; display:none;">
        <a href="#" id="profileLink">Profile</a>
        <a href="#" id="logoutLink">Logout</a>
      </div>
    </div>
  </div>

  <!-- Banner Section -->
  <div class="banner">
    <img
      src="https://dl.dropboxusercontent.com/scl/fi/xrm9oz497flxbgeg2ftbh/192f66_67551a1745204b0abb6b170d8aabdea5-mv2.jpg?rlkey=9os8s4wyc1f2mc5xclveeds9t&st=h763i6y8&dl=0"
      alt="Galaxy Banner"
    />
  </div>

  <!-- Description Section -->
  <div class="desc-section">
    <div class="desc-text">
      <h1>uw gzbskzj haosjj</h1>
      <p>
        whhaj wnus hcs hx w whhaj wnus hcs hx w whhaj wnus hcs hx w whhaj wnus hcs
        hx w whhaj wnus hcs hx w whhaj wnus hcs hx w whhaj wnus hcs hx w
      </p>
    </div>
    <div class="desc-img">
      <img
        src="https://dl.dropboxusercontent.com/scl/fi/ulfs6ygkeyvr4mar8bkuz/galaxwbewh.png?rlkey=jq9buj80ny6et6jfbfpiuf14l&st=lwkqobqi&dl=0"
        alt="Random PNG"
      />
    </div>
  </div>

  <!-- Cards Section -->
  <div id="cardsContainer" class="cards-section">
    <!-- Cards added dynamically here -->
  </div>

  <!-- Collaborators Section -->
  <div class="collaborators-wrap">
    <div class="collaborators-title">hamare lqwkq powkeqw</div>
    <div class="collaborators-section">
      <div class="collaborator-logo-box">
        <img
          src="https://upload.wikimedia.org/wikipedia/commons/4/44/Googlelogo.png"
          alt="lgwgo"
        />
        <div class="collaborator-label">pwwkq powkw</div>
      </div>
      <div class="collaborator-logo-box">
        <img
          src="https://upload.wikimedia.org/wikipedia/commons/a/a7/React-icon.svg"
          alt="rptpq"
        />
        <div class="collaborator-label">rpowkq</div>
      </div>
      <div class="collaborator-logo-box">
        <img
          src="https://upload.wikimedia.org/wikipedia/commons/6/6a/JavaScript-logo.png"
          alt="jspwo"
        />
        <div class="collaborator-label">ojqw powkeqw</div>
      </div>
    </div>
  </div>

  <!-- Footer Section -->
  <div class="footer">
    <div class="footer-links">
      <a href="https://twitter.com" title="Twitter"
        ><i class="fab fa-twitter"></i
      ></a>
      <a href="https://facebook.com" title="Facebook"
        ><i class="fab fa-facebook"></i
      ></a>
      <a href="https://instagram.com" title="Instagram"
        ><i class="fab fa-instagram"></i
      ></a>
      <a href="https://youtube.com" title="YouTube"
        ><i class="fab fa-youtube"></i
      ></a>
      <a href="https://discord.com" title="Discord"
        ><i class="fab fa-discord"></i
      ></a>
    </div>
    <div class="footer-legal">
      <a href="#">Privacy Policy</a>
      <a href="#">Terms & Conditions</a>
    </div>
    <div class="support-email">support@gmail.com</div>
    <span>&copy; 2025 GalaxyWeb. All rights reserved.</span>
  </div>

  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-check-compat.js"></script>
  <script src="https://www.google.com/recaptcha/api.js?render=6Ld395IrAAAAAIvG4gyf0vUJeI_jKOsI9XVn0jUx"></script>

  <script>
    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyBV7Jg0BVzeCNQW9oiIiNItnejUsjj2DhA",
      authDomain: "squadvertex2007.firebaseapp.com",
      projectId: "squadvertex2007",
      storageBucket: "squadvertex2007.appspot.com",
      messagingSenderId: "168905083514",
      appId: "1:168905083514:web:c8bbe2ce9f87800a0f09c3",
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);

    // Activate App Check
    try {
      const appCheckProvider = new firebase.appCheck.ReCaptchaV3Provider(
        "6Ld395IrAAAAAIvG4gyf0vUJeI_jKOsI9XVn0jUx"
      );
      firebase.appCheck().activate(appCheckProvider, true);
      console.log(
        "App Check (compat) activated — reCaptcha v3 provider attached."
      );
    } catch (e) {
      console.warn("App Check activation failed (compat):", e);
    }

    const auth = firebase.auth();
    const db = firebase.firestore();

    const profileBtn = document.getElementById("profileBtn");
    const profileMenu = document.getElementById("profileMenu");

    profileBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      profileMenu.style.display =
        profileMenu.style.display === "block" ? "none" : "block";
    });

    // Close profile menu if clicked outside
    window.addEventListener("click", () => {
      profileMenu.style.display = "none";
    });

    // Sign-In Function (Google OAuth)
    async function signIn() {
      const provider = new firebase.auth.GoogleAuthProvider();
      try {
        await auth.signInWithPopup(provider);
      } catch (error) {
        alert("Sign-in failed: " + error.message);
      }
    }

    // Sign-Out Function
    async function signOut() {
      try {
        await auth.signOut();
      } catch (error) {
        alert("Sign-out failed: " + error.message);
      }
    }

    // Track current user
    let currentUser = null;
    auth.onAuthStateChanged((user) => {
      currentUser = user;
      updateProfileButton();
      loadCards();
    });

    // Update Profile Button (show sign in or profile icon)
    function updateProfileButton() {
      if (currentUser) {
        profileBtn.innerHTML = '<i class="fa-solid fa-user"></i>';
        // Logout link inside the menu
        document.getElementById("logoutLink").onclick = async (e) => {
          e.preventDefault();
          await signOut();
        };
        // Profile link placeholder
        document.getElementById("profileLink").onclick = (e) => {
          e.preventDefault();
          alert("Profile clicked - implement profile page.");
        };
      } else {
        profileBtn.innerHTML = "Sign In";
        profileBtn.onclick = signIn;
      }
    }

    // Increment views once per session per card for visitor
    let visitedCards =
      JSON.parse(sessionStorage.getItem("visitedCards")) || [];

    // Load cards from Firestore
    async function loadCards() {
      const cardsContainer = document.getElementById("cardsContainer");
      cardsContainer.innerHTML = "";

      const snapshot = await db
        .collection("cards")
        .orderBy("publishedAt", "desc")
        .limit(3)
        .get();

      snapshot.docs.forEach((doc) => {
        const data = doc.data();
        const id = doc.id;

        // Increment views once if not visited this session
        if (!visitedCards.includes(id)) {
          db.collection("cards").doc(id).update({
            views: firebase.firestore.FieldValue.increment(1),
          });
          visitedCards.push(id);
          sessionStorage.setItem(
            "visitedCards",
            JSON.stringify(visitedCards)
          );
        }

        const card = createCard(
          id,
          data.heading,
          data.description,
          data.views || 0,
          data.likes || 0,
          data.imageUrl || ""
        );
        cardsContainer.appendChild(card);
      });
    }

    // Create a card element
    function createCard(id, heading, description, views, likes, imageUrl) {
      const card = document.createElement("div");
      card.className = "card";
      card.style.background = "rgba(24,31,43,0.85)";
      card.tabIndex = 0;
      card.setAttribute("role", "button");

      card.addEventListener("click", () => {
        window.location.href = `https://www.squadvertex.great-site.net/cards?id=${id}`;
      });
      card.addEventListener("keydown", (e) => {
        if (e.key === "Enter") {
          card.click();
        }
      });

      // Card image
      const img = document.createElement("img");
      img.src = imageUrl || "https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=500&q=80";
      img.alt = heading;
      img.style.height = "100px";
      img.style.width = "100%";
      img.style.objectFit = "cover";
      img.style.borderTopLeftRadius = "16px";
      img.style.borderTopRightRadius = "16px";
      img.style.marginBottom = "12px";
      card.appendChild(img);

      // Content container
      const content = document.createElement("div");
      content.className = "card-content";
      content.style.padding = "18px";
      content.style.flexGrow = "1";
      content.style.textAlign = "center";

      const h3 = document.createElement("h3");
      h3.textContent = heading || "uw gzbskzj haosjj";

      const p = document.createElement("p");
      p.textContent = description || "whhaj wnus hcs hx w whhaj hcs woqw kjqw qowq pwq.";

      content.appendChild(h3);
      content.appendChild(p);
      card.appendChild(content);

      // Footer container (views and likes)
      const footer = document.createElement("div");
      footer.className = "card-footer";
      footer.style.display = "flex";
      footer.style.justifyContent = "space-between";
      footer.style.alignItems = "center";
      footer.style.fontSize = "1rem";
      footer.style.opacity = "0.9";
      footer.style.padding = "0 18px 12px 18px";

      // Views
      const viewsSpan = document.createElement("span");
      viewsSpan.className = "views";
      viewsSpan.style.display = "flex";
      viewsSpan.style.alignItems = "center";
      viewsSpan.style.gap = "7px";
      viewsSpan.innerHTML = `<i class="fa-regular fa-eye"></i> ${views}`;
      footer.appendChild(viewsSpan);

      // Likes (if logged in only)
      const likesSpan = document.createElement("span");
      likesSpan.className = "likes";
      likesSpan.style.display = "flex";
      likesSpan.style.alignItems = "center";
      likesSpan.style.gap = "7px";
      likesSpan.style.cursor = currentUser ? "pointer" : "not-allowed";
      likesSpan.title = currentUser ? "Like" : "Sign In to Like";
      likesSpan.innerHTML = `<i class="fa-regular fa-heart"></i> ${likes}`;

      likesSpan.addEventListener("click", async (e) => {
        e.stopPropagation();
        if (!currentUser) {
          alert("Please sign in to like.");
          return;
        }
        // Check if user has liked already
        const likeDoc = await db
          .collection("cards")
          .doc(id)
          .collection("likes")
          .doc(currentUser.uid)
          .get();

        if (likeDoc.exists) {
          alert("You have already liked this card.");
          return;
        }
        try {
          // Add like doc
          await db.collection("cards").doc(id).collection("likes").doc(currentUser.uid).set({
            likedAt: firebase.firestore.FieldValue.serverTimestamp(),
          });
          // Increment likes count
          await db.collection("cards").doc(id).update({
            likes: firebase.firestore.FieldValue.increment(1),
          });
          // Update UI
          const newLikes = likes + 1;
          likesSpan.innerHTML = `<i class="fa-regular fa-heart"></i> ${newLikes}`;
          likesSpan.style.cursor = "default";
          likesSpan.title = "You liked this";
        } catch (err) {
          alert("Error liking card: " + err.message);
        }
      });

      footer.appendChild(likesSpan);
      card.appendChild(footer);

      return card;
    }
  </script>
</body>
</html>
