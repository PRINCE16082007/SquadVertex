<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Seat Manager Pro</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.0/font/bootstrap-icons.min.css"
    />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --success-color: #27ae60;
            --danger-color: #e74c3c;
            --text-color: #2c3e50;
            --bg-color: #ecf0f1;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            margin: 0px;
            padding: 0px;
            background: var(--bg-color);
            color: var(--text-color);
        }

      /* Navbar override */
      .navbar-brand {
        font-weight: bold;
        font-size: 1.5rem;
      }
      .navbar-nav .nav-link.active {
        position: relative;
        color: #fff;
        background-color: #007bff;
        border-radius: 5px;
        box-shadow: 0 0 8px rgba(0, 123, 255, 0.6);
      }
      .navbar-nav .nav-link.active::before {
        content: '';
        position: absolute;
        top: -5px;
        left: -5px;
        right: -5px;
        bottom: -5px;
        border-radius: 5px;
        border: 2px solid rgba(0, 123, 255, 0.6);
        opacity: 0.7;
        animation: glow 1.5s infinite alternate;
      }
      @keyframes glow {
        from {
          box-shadow: 0 0 8px rgba(0, 123, 255, 0.6);
        }
        to {
          box-shadow: 0 0 16px rgba(0, 123, 255, 0.8);
        }
      }

        .mobile-warning {
            display: none;
            background: var(--danger-color);
            color: white;
            padding: 15px;
            text-align: center;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
        }

        .container {
            max-width: 1400px;
            margin: 20px auto;
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 30px;
        }

        .student-list {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .student {
            padding: 12px;
            margin: 8px 0;
            border-radius: 8px;
            transition: transform 0.2s;
            cursor: grab;
        }

        .student:hover {
            transform: translateX(5px);
        }

        .settings-panel {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .room {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .grid {
            display: grid;
            gap: 8px;
            margin-top: 15px;
        }

        .seat {
            width: 65px;
            height: 65px;
            border: 2px solid #bdc3c7;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.85em;
            transition: all 0.2s;
        }

        .seat:hover {
            border-color: var(--secondary-color);
        }

        .stats-panel {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-top: 30px;
        }

        .male { background-color: #d6eaf8; border-color: #3498db; }
        .female { background-color: #fadbd8; border-color: #e74c3c; }
        .occupied { background-color: #e8f6ea; }
        .hidden { display: none; }

        button {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            background: var(--secondary-color);
            color: white;
        }

        select, input {
            padding: 8px;
            border: 2px solid #bdc3c7;
            border-radius: 6px;
            margin: 5px 0;
        }

        @media (max-width: 768px) {
            .mobile-warning { display: block; }
            .container { display: none; }
        }
.footer-container {
  max-width: 1200px;
  margin: 0 auto;
  display: flex;
  justify-content: space-between; /* Ensure elements are spaced evenly */
  align-items: center;
  width: 100%;
  padding: 0 20px;
}
    </style>
</head>
<body>  
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <div class="container-fluid">
        <a class="navbar-brand" href="#">SchoolMS</a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarContent"
          aria-controls="navbarContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarContent">
          <ul class="navbar-nav me-auto">
            <li class="nav-item">
              <a class="nav-link" href="../admin_dashboard.html">Dashboard</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="../admission/admission.html">Admissions</a>
            </li>
            <li class="nav-item">
              <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">
                Staff <span class="bi bi-lock"></span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="../attendance/attendance.html">Attendance</a>
            </li>
            <li class="nav-item">
              <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">
                Classes <span class="bi bi-lock"></span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="../fees_module/fees_module.html">Payment Module</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="exam_module.html">Exams</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="../library/library.html">Library</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#" tabindex="-1" aria-disabled="true">
                Transport <span class="bi bi-lock"></span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="../hostel/hostel.html">Hostel</a>
            </li>
            <li class="nav-item">
              <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">
                Communications <span class="bi bi-lock"></span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">
                Inventory <span class="bi bi-lock"></span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="../events/events.html">Events</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="../admin_panel/admin_panel.html">Admin &amp; Settings panel</a>
            </li>
            <li class="nav-item">
              <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">
                Reports <span class="bi bi-lock"></span>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
  <style>
    /* Optional extra CSS: using border color to indicate gender */
    .male { /* additional styles if needed */ }
    .female { /* additional styles if needed */ }
  </style>
<div class="mobile-warning">‚ö†Ô∏è Please use desktop view for best experience!</div>  
<h1 style="color: var(--primary-color); text-align: center; margin: 30px 0;">ü™ë Smart Seat Manager Pro</h1>  
<div class="file-manager">  
  <button onclick="createNewFile()">üìÅ New File</button>  
  <select id="fileSelector" onchange="loadFile(this.value)"></select>  
</div>  
<div class="settings-panel">  
  <h2 style="margin:10px 0;">‚öôÔ∏è Room Configuration</h2>  
  <div id="room-settings-container"></div>  
  <button onclick="addNewRoom()">‚ûï Add New Room</button>  
</div>  
<div class="container">  
  <div class="student-list" id="studentListContainer">  
    <h2>üéì Students</h2>  
    <div id="student-sort-container" style="margin-bottom:10px;">  
      Sort by:   
      <select id="studentSort" onchange="generateStudentsList()">  
        <option value="default">Default</option>  
        <option value="class">Class</option>  
        <option value="gender">Gender</option>  
        <option value="Arts">Arts</option>  
        <option value="Commerce">Commerce</option>  
        <option value="Science">Science</option>  
        <option value="Hindi">Hindi</option>  
        <option value="English">English</option>  
        <option value="Math">Math</option>  
        <option value="History">History</option>  
        <option value="Geography">Geography</option>  
        <option value="Political Science">Political Science</option>  
        <option value="Physics">Physics</option>  
        <option value="Chemistry">Chemistry</option>  
        <option value="Biology">Biology</option>  
        <option value="Economics">Economics</option>  
        <option value="Accountancy">Accountancy</option>  
        <option value="Business Studies">Business Studies</option>  
      </select>  
    </div>  
    <div id="students" style="min-height:150px; max-height:400px; overflow-y:auto;"></div>  
  </div>  
  <div id="rooms-container"></div>  
</div>  
<div class="stats-panel" id="stats-container"></div>  
<footer class="footer-section" style="background-color: #f8f9fa; padding: 20px 0; border-top: 1px solid #ccc; margin-top: 40px;">
  <div class="footer-container">
    <div class="row align-items-center" style="width: 100%;">
      <!-- Social Links -->
      <div class="col-md-4 text-center">
        <h3 style="margin-bottom: 15px;">Connect with Us</h3>
        <div class="social-links">
          <a href="https://www.instagram.com/squadvertex/?igsh=YzljYTk1ODg3Zg%3D%3D#" target="_blank" title="Instagram" style="margin-right: 10px;">
            <img src="https://img.icons8.com/color/48/instagram-new.png" alt="Instagram" style="width:32px; height:32px;">
          </a>
          <a href="https://x.com/SquadVertex_?t=iw82z-AjSDlmZxTzNid9sw&s=09" target="_blank" title="Twitter" style="margin-right: 10px;">
            <img src="https://img.icons8.com/color/48/twitter.png" alt="Twitter" style="width:32px; height:32px;">
          </a>
          <a href="https://discord.gg/dyWSDFREWZ" target="_blank" title="Discord" style="margin-right: 10px;">
            <img src="https://img.icons8.com/color/48/discord-logo.png" alt="Discord" style="width:32px; height:32px;">
          </a>
          <a href="https://youtube.com/@prince_squadvertex?si=djSrTHGczq73iFOi" target="_blank" title="YouTube">
            <img src="https://img.icons8.com/color/48/youtube-play.png" alt="YouTube" style="width:32px; height:32px;">
          </a>
        </div>
      </div>
      <!-- Copyright -->
      <div class="col-md-4 text-center">
        <p style="margin: 0;">&copy; 2025 SquadVertex. All rights reserved.</p>
      </div>
      <!-- Docs Redirect Button -->
      <div class="col-md-4 text-center">
        <a href="https://www.squadvertex.great-site.net/001-school/001-school_docs.html" target="_blank" class="btn btn-outline-primary" style="border-radius: 20px; padding: 6px 20px;">
          Docs
        </a>
      </div>
    </div>
  </div>
</footer>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>  
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>  
<script>
  const firebaseConfig = {  
    apiKey: "AIzaSyBV7Jg0BVzeCNQW9oiIiNItnejUsjj2DhA",  
    authDomain: "squadvertex2007.firebaseapp.com",  
    projectId: "squadvertex2007",  
    storageBucket: "squadvertex2007.appspot.com",  
    messagingSenderId: "168905083514",  
    appId: "1:168905083514:web:c8bbe2ce9f87800a0f09c3"  
  };  
  firebase.initializeApp(firebaseConfig);  
  const db = firebase.firestore();  

  // Icon mapping for stream and subjects  
  const streamIcons = {  
    "Arts": "üé®",  
    "Science": "üî¨",  
    "Commerce": "üíº"  
  };  
  function getStreamIcon(stream) {  
    return streamIcons[stream] || stream;  
  }  
  const subjectIcons = {  
    "Math": "‚ûï",  
    "Geography": "üåç",  
    "Political Science": "üèõÔ∏è",  
    "History": "üìú",  
    "Economics": "üí∞",  
    "Biology": "üß¨",  
    "Physics": "‚öõÔ∏è",  
    "Chemistry": "üß™",  
    "Hindi": "üìù",  
    "English": "üìö",  
    "Accountancy": "üíµ",  
    "Business Studies": "üìà"  
  };  
  function getSubjectIcon(subject) {  
    return subjectIcons[subject] || subject;  
  }  

  let currentFile = null;  
  const config = { students: [], rooms: [], files: [] };  

  function updateSeatingArray(oldSeating, oldRows, oldCols, newRows, newCols) {  
    const newSeating = Array(newRows * newCols).fill(null);  
    for (let i = 0; i < Math.min(oldRows, newRows); i++) {  
      for (let j = 0; j < Math.min(oldCols, newCols); j++) {  
        newSeating[i * newCols + j] = oldSeating[i * oldCols + j];  
      }  
    }  
    return newSeating;  
  }  

  async function init() {  
    try {  
      // Map studentName to name and use gender as stored ("Male"/"Female")  
      const studentsSnap = await db.collection("001-school").doc("students").collection("list").get();  
      config.students = studentsSnap.docs.map(d => {  
        const data = d.data();  
        return {  
          id: d.id,  
          name: data.studentName,  
          gender: data.gender,  
          ...data  
        };  
      });  
      const filesSnap = await db.collection("001-school").doc("rooms").collection("files").get();  
      config.files = await Promise.all(filesSnap.docs.map(async f => ({  
        id: f.id,  
        name: f.data().name,  
        rooms: (await f.ref.collection("layouts").get()).docs.map(r => ({ id: r.id, ...r.data() }))  
      })));  
      updateFileSelector();  
      if (config.files.length > 0) {  
        currentFile = config.files[0].id;  
        loadFile(currentFile);  
      } else {  
        createNewFile();  
      }  
    } catch (e) {  
      console.error("Init error:", e);  
      alert("Error loading data!");  
    }  
  }  

  async function createNewFile() {  
    try {  
      let fileName = prompt("Enter file name:", "New File " + new Date().toLocaleDateString());  
      if (!fileName) {  
        fileName = "New File " + new Date().toLocaleDateString();  
      }  
      const fileRef = await db.collection("001-school").doc("rooms").collection("files").add({  
        name: fileName,  
        createdAt: firebase.firestore.FieldValue.serverTimestamp(),  
        updatedAt: firebase.firestore.FieldValue.serverTimestamp()  
      });  
      currentFile = fileRef.id;  
      config.files.push({ id: fileRef.id, name: fileName, rooms: [] });  
      updateFileSelector();  
      loadFile(currentFile);  
    } catch (e) {  
      console.error("File creation error:", e);  
      alert("Error creating file!");  
    }  
  }  

  async function loadFile(fileId) {  
    currentFile = fileId;  
    try {  
      const layoutsSnap = await db.collection("001-school").doc("rooms").collection("files").doc(currentFile).collection("layouts").get();  
      config.rooms = layoutsSnap.docs.map(r => ({ id: r.id, ...r.data() }));  
    } catch (e) {  
      console.error("Error loading layouts:", e);  
      config.rooms = [];  
    }  
    createSettingsPanel();  
    createRooms();  
    generateStudentsList();  
    updateStats();  
  }  

  function updateFileSelector() {  
    document.getElementById("fileSelector").innerHTML = config.files.map(f => `<option value="${f.id}" ${f.id === currentFile ? "selected" : ""}>${f.name}</option>`).join("");  
  }  

  async function addNewRoom() {  
    if (!currentFile) {  
      alert("No file selected!");  
      return;  
    }  
    try {  
      const rows = 5, cols = 5;  
      const roomRef = await db.collection("001-school").doc("rooms").collection("files").doc(currentFile).collection("layouts").add({  
        name: "New Room",  
        type: "Mixed",  
        rows: rows,  
        cols: cols,  
        seating: Array(rows * cols).fill(null),  
        neighborCheck: "none",  
        createdAt: firebase.firestore.FieldValue.serverTimestamp(),  
        updatedAt: firebase.firestore.FieldValue.serverTimestamp()  
      });  
      const roomData = (await roomRef.get()).data();  
      config.rooms.push({ id: roomRef.id, ...roomData });  
      createSettingsPanel();  
      createRooms();  
      updateStats();  
    } catch (e) {  
      console.error("Room creation error:", e);  
      alert("Error creating room!");  
    }  
  }  