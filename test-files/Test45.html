<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Profile - TeamGalaxy</title>
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
      background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
      color: #e0e0ff;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* Header */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 2rem;
      background: rgba(10, 10, 35, 0.95);
      backdrop-filter: blur(15px);
      border-bottom: 1px solid #5a4fcf;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .logo {
      font-size: 2rem;
      font-weight: bold;
      color: #8a7cff;
      letter-spacing: 1.5px;
      text-shadow: 0 0 10px rgba(138, 124, 255, 0.5);
      background: linear-gradient(45deg, #8a7cff, #d66efd);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .header-buttons {
      display: flex;
      gap: 1rem;
    }

    .btn {
      padding: 0.7rem 1.4rem;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
      font-size: 0.95rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .btn-settings {
      background: linear-gradient(45deg, #5a4fcf, #6a5af9);
      color: white;
      box-shadow: 0 4px 15px rgba(90, 79, 207, 0.3);
    }

    .btn-settings:hover {
      background: linear-gradient(45deg, #6a5af9, #7a6bfa);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(90, 79, 207, 0.4);
    }

    .btn-logout {
      background: linear-gradient(45deg, #ff6b6b, #ff8e8e);
      color: white;
      box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
    }

    .btn-logout:hover {
      background: linear-gradient(45deg, #ff8e8e, #ff9f9f);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
    }

    /* Main Content */
    .container {
      max-width: 1200px;
      margin: 2rem auto;
      padding: 0 1.5rem;
      flex: 1;
    }

    .profile-card {
      background: rgba(20, 20, 40, 0.85);
      border-radius: 20px;
      padding: 3rem;
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
      border: 1px solid #5a4fcf;
      backdrop-filter: blur(10px);
      margin-bottom: 2rem;
    }

    .profile-header {
      display: flex;
      align-items: center;
      gap: 2rem;
      margin-bottom: 2.5rem;
      flex-wrap: wrap;
    }

    .profile-photo {
      width: 150px;
      height: 150px;
      border-radius: 50%;
      object-fit: cover;
      border: 4px solid #6a5af9;
      background: linear-gradient(45deg, #6a5af9, #d66efd);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 4rem;
      box-shadow: 0 0 20px rgba(106, 90, 249, 0.3);
    }

    .profile-info {
      flex: 1;
      min-width: 300px;
    }

    .profile-name {
      font-size: 2.5rem;
      font-weight: bold;
      color: #ffffff;
      margin-bottom: 0.5rem;
      text-shadow: 0 0 10px rgba(255, 255, 255, 0.2);
    }

    .profile-slug {
      font-size: 1.3rem;
      color: #b1a6ff;
      margin-bottom: 0.8rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .verified-badge {
      display: inline-block;
      background: linear-gradient(45deg, #6a5af9, #d66efd);
      color: white;
      padding: 0.3rem 1rem;
      border-radius: 20px;
      font-size: 1rem;
      font-weight: bold;
      box-shadow: 0 0 10px rgba(106, 90, 249, 0.3);
    }

    .join-date, .email {
      color: #a0a0d0;
      font-size: 1.1rem;
      margin: 0.3rem 0;
    }

    .bio-section {
      margin: 2.5rem 0;
    }

    .section-title {
      font-size: 1.5rem;
      font-weight: 600;
      color: #d0c4ff;
      margin-bottom: 1.5rem;
      padding-bottom: 0.8rem;
      border-bottom: 2px solid #5a4fcf;
      display: flex;
      align-items: center;
      gap: 0.8rem;
    }

    .bio-text {
      line-height: 1.7;
      color: #c0c0e0;
      font-size: 1.15rem;
      margin-bottom: 1.5rem;
    }

    .bio-edit {
      margin-top: 1.5rem;
    }

    .bio-textarea {
      width: 100%;
      padding: 1rem;
      border-radius: 10px;
      background: rgba(30, 30, 50, 0.7);
      border: 1px solid #5a4fcf;
      color: #e0e0ff;
      font-size: 1.1rem;
      line-height: 1.6;
      resize: vertical;
      min-height: 120px;
      margin-bottom: 1rem;
    }

    .btn-save-bio {
      background: linear-gradient(45deg, #5a4fcf, #6a5af9);
      color: white;
      border: none;
      padding: 0.8rem 1.8rem;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      font-size: 1rem;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(90, 79, 207, 0.3);
    }

    .btn-save-bio:hover {
      background: linear-gradient(45deg, #6a5af9, #7a6bfa);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(90, 79, 207, 0.4);
    }

    .profile-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 2rem;
      margin-top: 2.5rem;
    }

    .stat-card {
      background: rgba(40, 40, 70, 0.6);
      padding: 2rem;
      border-radius: 15px;
      text-align: center;
      border: 1px solid #5a4fcf;
      transition: transform 0.3s ease;
    }

    .stat-card:hover {
      transform: translateY(-5px);
    }

    .stat-value {
      font-size: 2.5rem;
      font-weight: bold;
      color: #8a7cff;
      margin-bottom: 0.8rem;
      text-shadow: 0 0 10px rgba(138, 124, 255, 0.3);
    }

    .stat-label {
      color: #b1a6ff;
      font-size: 1.1rem;
    }

    /* Footer */
    .footer {
      background: rgba(10, 10, 35, 0.95);
      padding: 3rem 2rem 2rem;
      margin-top: 3rem;
      border-top: 1px solid #5a4fcf;
      box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.3);
    }

    .footer-content {
      max-width: 1200px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 3rem;
    }

    .footer-about-title {
      font-size: 1.5rem;
      color: #8a7cff;
      margin-bottom: 1.2rem;
      font-weight: 600;
      text-shadow: 0 0 10px rgba(138, 124, 255, 0.3);
    }

    .footer-about-text {
      color: #b1a6ff;
      line-height: 1.7;
      font-size: 1.05rem;
    }

    .footer-links {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .footer-links a {
      color: #b1a6ff;
      text-decoration: none;
      font-size: 1.05rem;
      transition: color 0.3s ease;
      position: relative;
      padding-left: 1rem;
    }

    .footer-links a:before {
      content: "‚ñ∂";
      position: absolute;
      left: 0;
      color: #8a7cff;
      font-size: 0.8rem;
      transition: transform 0.3s ease;
    }

    .footer-links a:hover {
      color: #8a7cff;
      text-decoration: underline;
    }

    .footer-links a:hover:before {
      transform: translateX(3px);
    }

    .rocket-frame {
      margin-top: 2rem;
      padding: 1.5rem;
      border: 2px solid #5a4fcf;
      border-radius: 12px;
      background: rgba(20, 20, 40, 0.5);
      position: relative;
      overflow: hidden;
    }

    .rocket-text {
      font-size: 1.8rem;
      font-weight: bold;
      color: #8a7cff;
      text-align: center;
      text-shadow: 0 0 15px rgba(138, 124, 255, 0.6);
      background: linear-gradient(45deg, #8a7cff, #d66efd, #8a7cff);
      background-size: 200% auto;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: shimmer 3s linear infinite;
      font-family: 'Arial Rounded MT Bold', 'Segoe UI', sans-serif;
    }

    @keyframes shimmer {
      0% { background-position: -200% center; }
      100% { background-position: 200% center; }
    }

    /* Loading */
    .loading {
      text-align: center;
      padding: 4rem;
      font-size: 1.5rem;
      color: #a0a0d0;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .header {
        flex-direction: column;
        gap: 1.2rem;
        padding: 1.2rem;
      }

      .profile-header {
        flex-direction: column;
        text-align: center;
      }

      .footer-content {
        grid-template-columns: 1fr;
      }

      .profile-card {
        padding: 2rem 1.5rem;
      }

      .profile-name {
        font-size: 2rem;
      }
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="logo">GalaxyWeb</div>
    <div class="header-buttons">
      <button class="btn btn-settings">‚öôÔ∏è Settings</button>
      <button class="btn btn-logout">üö™ Log Out</button>
    </div>
  </header>

  <!-- Main Content -->
  <div class="container">
    <div id="profile-content">
      <div class="loading">Loading profile...</div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-content">
      <div class="footer-left">
        <div class="footer-about-title">About TeamGalaxy</div>
        <div class="footer-about-text">
          TeamGalaxy is an innovative gaming and creative community, united by passion and the spirit of collaboration. We host tournaments, share design ideas, and grow talents together ‚Äî join now to explore the Galaxy!
        </div>
      </div>
      <div class="footer-right">
        <div class="footer-links">
          <a href="#">Privacy Policy</a>
          <a href="#">Terms & Conditions</a>
          <a href="#">About</a>
        </div>
        <div class="rocket-frame">
          <div class="rocket-text">üöÄ ROCKET üöÄ</div>
        </div>
      </div>
    </div>
  </footer>

  <script>
    // Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyD0Yv_bQjxi2_kjzPR4XHOlaB7Sb6NRVUc",
      authDomain: "teamgalaxy-77344.firebaseapp.com",
      projectId: "teamgalaxy-77344",
      storageBucket: "teamgalaxy-77344.firebasestorage.app",
      messagingSenderId: "770256225320",
      appId: "1:770256225320:web:5a363ebd757de6cde3a11d",
      measurementId: "G-6C2W9NSNCH"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // DOM Elements
    const profileContent = document.getElementById('profile-content');
    const logoutBtn = document.querySelector('.btn-logout');
    const settingsBtn = document.querySelector('.btn-settings');

    // Format date
    function formatDate(dateString) {
      if (!dateString) return '';
      const date = new Date(dateString);
      return date.toLocaleDateString('en-US', { 
        year: 'numeric', 
        month: 'long', 
        day: 'numeric' 
      });
    }

    // Format number (e.g., 1000 -> 1K)
    function formatNumber(num) {
      if (num >= 1000000) {
        return (num / 1000000).toFixed(1) + 'M';
      }
      if (num >= 1000) {
        return (num / 1000).toFixed(1) + 'K';
      }
      return num.toString();
    }

    // Load profile data
    async function loadProfile() {
      const user = auth.currentUser;
      if (!user) {
        profileContent.innerHTML = '<div class="loading">Please log in to view your profile.</div>';
        return;
      }

      try {
        const docRef = db.collection('usersPrivate').doc(user.uid);
        const doc = await docRef.get();

        if (!doc.exists) {
          profileContent.innerHTML = '<div class="loading">Profile not found.</div>';
          return;
        }

        const data = doc.data();
        renderProfile(data);
      } catch (error) {
        console.error('Error loading profile:', error);
        profileContent.innerHTML = '<div class="loading">Error loading profile.</div>';
      }
    }

    // Render profile HTML
    function renderProfile(data) {
      profileContent.innerHTML = `
        <div class="profile-card">
          <!-- Profile Header -->
          <div class="profile-header">
            <img src="${data.profilePhotoUrl || 'https://via.placeholder.com/150'}" alt="Profile Photo" class="profile-photo">
            <div class="profile-info">
              <h1 class="profile-name">${data.name || 'Unknown User'}</h1>
              <div class="profile-slug">${data.slug ? '@' + data.slug : ''}${data.verified ? '<span class="verified-badge">‚úì Verified</span>' : ''}</div>
              <div class="join-date">üìÖ Joined: ${formatDate(data.joinDate)}</div>
              <div class="email">‚úâÔ∏è ${data.email || ''}</div>
            </div>
          </div>

          <!-- Bio Section -->
          <div class="bio-section">
            <h2 class="section-title">üìù Bio</h2>
            <p class="bio-text" id="bio-display">${data.bio || 'No bio available. Add one below!'}</p>
            
            <div class="bio-edit">
              <textarea class="bio-textarea" id="bio-input" placeholder="Write your bio here...">${data.bio || ''}</textarea>
              <button class="btn-save-bio" id="save-bio-btn">üíæ Save Bio</button>
            </div>
          </div>

          <!-- Stats Section -->
          <div class="profile-stats">
            <div class="stat-card">
              <div class="stat-value">${formatNumber(data.publicPostCount || 0)}</div>
              <div class="stat-label">Public Posts</div>
            </div>
          </div>
        </div>
      `;

      // Add event listener for save bio button
      document.getElementById('save-bio-btn').addEventListener('click', async () => {
        const newBio = document.getElementById('bio-input').value;
        const user = auth.currentUser;
        
        if (!user) return;
        
        try {
          await db.collection('usersPrivate').doc(user.uid).update({
            bio: newBio
          });
          
          // Update the displayed bio
          document.getElementById('bio-display').textContent = newBio || 'No bio available.';
          alert('Bio updated successfully!');
        } catch (error) {
          console.error('Error updating bio:', error);
          alert('Error updating bio. Please try again.');
        }
      });
    }

    // Auth state listener
    auth.onAuthStateChanged((user) => {
      if (user) {
        loadProfile();
      } else {
        profileContent.innerHTML = '<div class="loading">Please log in to view your profile.</div>';
      }
    });

    // Logout functionality
    logoutBtn.addEventListener('click', () => {
      auth.signOut().then(() => {
        console.log('User signed out');
        alert('Successfully logged out!');
      }).catch((error) => {
        console.error('Sign out error:', error);
        alert('Error signing out. Please try again.');
      });
    });

    // Settings functionality
    settingsBtn.addEventListener('click', () => {
      alert('Settings page would open here');
    });
  </script>
</body>
</html>