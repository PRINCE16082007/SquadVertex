<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
<title>TeamGalaxy - Entry Portal (Enhanced)</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
<style>
  /* Reset + basics */
  *{box-sizing:border-box;margin:0;padding:0}
  html,body{width:100%;height:100%;overflow:hidden;background:#000;font-family:'Segoe UI',Tahoma, Geneva, Verdana, sans-serif;color:#fff}
  :root{
    --gold-1:#ffd700;--gold-2:#ff8c00;--accent:#357abd;
  }

  /* Full-screen layers order (back to front) */
  #canvasStars{position:fixed;inset:0;z-index:0}
  .nebula{position:fixed;inset:0;z-index:1;pointer-events:none;mix-blend-mode:screen;opacity:0.85}
  .nebula .layer{position:absolute;inset:0;filter:blur(44px) contrast(1.05) saturate(1.2)}
  #particles{position:fixed;inset:0;z-index:2;pointer-events:none}
  /* subtle vignette */
  .vignette{position:fixed;inset:0;z-index:4;pointer-events:none;background:radial-gradient(ellipse at center, rgba(0,0,0,0) 45%, rgba(0,0,0,0.55) 100%);mix-blend-mode:multiply}

  /* Content */
  .content{position:fixed;inset:0;z-index:10;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:24px;text-align:center;pointer-events:auto}
  .logo{font-weight:900;font-size:clamp(2.2rem,7vw,4rem);letter-spacing:3px;position:relative;padding:6px 12px;background:linear-gradient(90deg,var(--gold-1),var(--gold-2));background-clip:text;-webkit-background-clip:text;color:transparent;text-shadow:0 0 22px rgba(255,215,0,0.18)}
  .tagline{color:#e9f0ff90;margin-top:8px;max-width:820px;line-height:1.4;font-size:clamp(0.95rem,2.5vw,1.15rem);text-shadow:0 0 10px rgba(0,0,0,0.3)}
  .control-panel{margin-top:28px;background:rgba(12,16,28,0.6);backdrop-filter:blur(8px);border:1px solid rgba(60,120,255,0.08);padding:16px;border-radius:12px;box-shadow:0 8px 40px rgba(20,30,60,0.6);max-width:min(600px,92%);width:100%}
  .status-indicators{display:flex;justify-content:space-around;gap:12px}
  .status{display:flex;flex-direction:column;align-items:center}
  .status-dot{width:12px;height:12px;border-radius:50%;box-shadow:0 0 12px rgba(0,0,0,0.25)}
  .status.online .status-dot{background:#35ff9b;box-shadow:0 0 12px #35ff9b}
  .status.ready .status-dot{background:#ffea64;box-shadow:0 0 12px #ffea64}
  .status.active .status-dot{background:#ff6b4b;box-shadow:0 0 12px #ff6b4b}
  .status-text{font-size:0.8rem;color:#bfcbe7;opacity:0.9;margin-top:6px}

  .progress-container{height:6px;background:rgba(255,255,255,0.06);border-radius:3px;margin-top:12px;overflow:hidden}
  .progress-bar{height:100%;width:0;background:linear-gradient(90deg,var(--gold-1),var(--gold-2));transition:width 0.3s linear}

  .enter-btn{margin-top:18px;padding:14px 36px;border-radius:999px;border:none;cursor:pointer;background:linear-gradient(180deg,var(--gold-1),var(--gold-2));color:#000;font-weight:800;box-shadow:0 8px 40px rgba(255,180,30,0.15);transition:transform .18s ease,box-shadow .18s}
  .enter-btn:hover{transform:translateY(-2px) scale(1.02);box-shadow:0 18px 60px rgba(255,180,30,0.22)}
  .countdown{margin-top:12px;color:var(--gold-1);font-weight:700;text-shadow:0 0 18px rgba(255,215,0,0.25)}
  .loading-text,.subtext{margin-top:6px;color:#bfcbe790;font-size:0.9rem}

  .footer{position:fixed;bottom:22px;left:0;width:100%;text-align:center;color:#7d8da8;z-index:30;opacity:0;transition:opacity .8s}
  .footer.show{opacity:1}

  /* Spaceship improved */
  .spaceship-container{position:fixed;left:50%;bottom:-260px;transform:translateX(-50%);z-index:20;will-change:transform,opacity}
  .spaceship{width:clamp(80px,20vw,160px);height:clamp(120px,32vw,220px);position:relative;transform-style:preserve-3d;filter:drop-shadow(0 30px 45px rgba(0,0,0,0.6))}

  /* body + panels (kept your structure but refined) */
  .nose-cone{position:absolute;left:50%;transform:translateX(-50%);top:-36px;border-left:26px solid transparent;border-right:26px solid transparent;border-bottom:46px solid #7fb9ff;border-radius:14px;filter:drop-shadow(0 0 14px rgba(123,190,255,0.35))}
  .nose-highlight{position:absolute;left:50%;top:-18px;transform:translateX(-50%);width:16px;height:16px;border-radius:50%;background:radial-gradient(circle,#fff,#a6d8ff);box-shadow:0 0 20px rgba(166,216,255,0.95)}
  .ship-body{position:absolute;left:50%;transform:translateX(-50%);top:0;width:60px;height:120px;border-radius:50% 50% 42% 42%;background:linear-gradient(180deg,#4a90e2,#2a6fb3);box-shadow:inset 0 -8px 28px rgba(0,0,0,0.6),0 0 36px rgba(53,122,189,0.22)}
  .cockpit{position:absolute;left:50%;transform:translateX(-50%);top:28px;width:34px;height:34px;border-radius:50%;background:radial-gradient(circle at 30% 25%,#fff,#a8d9ff 24%,#2b5270 90%);box-shadow:0 0 34px rgba(170,220,255,0.9), inset 0 -8px 18px rgba(0,0,0,0.3)}
  .cockpit-frame{position:absolute;left:50%;transform:translateX(-50%);top:26px;width:40px;height:40px;border-radius:50%;border:3px solid rgba(40,55,72,0.95)}
  .panel-1,.panel-2,.panel-3{position:absolute;left:50%;transform:translateX(-50%);height:6px;background:linear-gradient(90deg,#2f7dbf,#54a7e5);border-radius:3px;box-shadow:0 0 6px rgba(60,160,230,0.25)}
  .panel-1{top:18px;width:46px}.panel-2{top:36px;width:52px}.panel-3{top:56px;width:46px}

  /* wings + fins */
  .fin-left,.fin-right{position:absolute;top:70px;width:0;height:0;border-top:30px solid transparent;border-bottom:30px solid transparent;z-index:1}
  .fin-left{left:-14px;border-left:22px solid #e74c3c;transform:rotate(-12deg);filter:drop-shadow(0 0 8px rgba(231,76,60,0.15))}
  .fin-right{right:-14px;border-right:22px solid #e74c3c;transform:rotate(12deg);filter:drop-shadow(0 0 8px rgba(231,76,60,0.15))}
  .fin-detail-left,.fin-detail-right{position:absolute;top:70px;width:12px;height:34px;border-radius:4px;background:linear-gradient(90deg,#c0392b,#e74c3c);z-index:2}
  .fin-detail-left{left:-8px;transform:rotate(-10deg)}.fin-detail-right{right:-8px;transform:rotate(10deg)}

  /* engines and flames (we animate with JS to create layered blur + scale) */
  .engine-section{position:absolute;left:50%;transform:translateX(-50%);top:94px;width:46px;height:28px;border-radius:0 0 12px 12px;background:linear-gradient(180deg,#3a5166,#273241);box-shadow:inset 0 -6px 10px rgba(0,0,0,0.6)}
  .engine-left,.engine-right{position:absolute;bottom:-18px;width:14px;height:24px;border-radius:8px;background:linear-gradient(180deg,#3d566e,#2c3e50);z-index:2}
  .engine-left{left:8px}.engine-right{right:8px}

  /* core flame dom element - we'll layer canvas/exhaust behind it for realism */
  .main-engine{position:absolute;left:50%;transform:translateX(-50%);top:120px;width:26px;height:40px;border-radius:50%;background:linear-gradient(to top,#ff4b2b,#ff9c2b,#fff);filter:blur(6px);opacity:0;mix-blend-mode:screen}
  .side-engine-left,.side-engine-right{position:absolute;top:122px;width:12px;height:36px;border-radius:50%;filter:blur(4px);opacity:0}
  .side-engine-left{left:26%}.side-engine-right{right:26%}

  /* exhaust canvas container sits behind spaceship to hold thousands of small particles efficiently */
  #exhaustCanvas{position:fixed;left:0;bottom:0;width:100%;height:100%;z-index:18;pointer-events:none}

  /* micro sparks near engines */
  .spark{position:absolute;width:4px;height:4px;border-radius:50%;background:linear-gradient(90deg,#fff7c9,#ffb36b);filter:blur(.8px);opacity:0;will-change:transform,opacity}

  /* lens flare (SVG overlay) */
  .lensflare{position:fixed;left:50%;top:30%;transform:translateX(-50%);z-index:19;pointer-events:none;mix-blend-mode:screen;opacity:0.55;filter:blur(6px) saturate(1.2)}
  .lensflare svg{width:520px;height:520px}

  /* tiny motion blur via transform + opacity */
  .trail{position:absolute;opacity:0.08;filter:blur(12px);pointer-events:none;mix-blend-mode:screen}

  /* Subtle UI entry animations */
  .fade-in{animation:fadeInUp .9s cubic-bezier(.2,.9,.1,1) both}
  @keyframes fadeInUp{from{opacity:0;transform:translateY(18px)}to{opacity:1;transform:none}}

  /* small responsive tweaks */
  @media (max-width:520px){.control-panel{padding:12px}.logo{font-size:2rem}}
</style>
</head>
<body>
  <!-- fast canvas-based starfield (multiple depth layers) -->
  <canvas id="canvasStars"></canvas>

  <!-- volumetric nebula layers (soft radial gradients) -->
  <div class="nebula" aria-hidden="true">
    <div class="layer" style="background:
        radial-gradient(circle at 20% 80%, rgba(120,119,198,0.22) 0%, transparent 30%),
        radial-gradient(circle at 80% 20%, rgba(255,100,124,0.12) 0%, transparent 28%),
        radial-gradient(circle at 40% 40%, rgba(100,200,255,0.16) 0%, transparent 35%);"></div>
    <div class="layer" style="transform:scale(1.1) rotate(8deg);opacity:0.65;filter:blur(62px) contrast(1.04)">
    </div>
  </div>

  <!-- exhaust particle canvas sits behind spaceship -->
  <canvas id="exhaustCanvas"></canvas>

  <!-- DOM layer for small glow/sparks and parallax micro-particles -->
  <div id="particles"></div>

  <div class="vignette"></div>

  <div class="content">
    <div class="logo fade-in" style="--delay:0s">TEAMGALAXY</div>
    <p class="tagline fade-in" style="--delay:.08s">Where Gamers Unite and Communities Thrive</p>

    <div class="control-panel fade-in" style="--delay:.16s">
      <div class="status-indicators">
        <div class="status online"><div class="status-dot"></div><div class="status-text">ONLINE</div></div>
        <div class="status ready"><div class="status-dot"></div><div class="status-text">READY</div></div>
        <div class="status active"><div class="status-dot"></div><div class="status-text">ACTIVE</div></div>
      </div>
      <div class="progress-container"><div id="progressBar" class="progress-bar"></div></div>
    </div>

    <button id="enterBtn" class="enter-btn fade-in" style="--delay:.28s">INITIATE LAUNCH</button>
    <div id="countdown" class="countdown fade-in" style="--delay:.40s">AUTO-LAUNCH IN: 5</div>
    <p class="loading-text">Initializing experience...</p>
    <p class="subtext">Powered by innovation and collaboration</p>
  </div>

  <!-- lens flare SVG -->
  <div class="lensflare" aria-hidden="true">
    <svg viewBox="0 0 600 600" preserveAspectRatio="xMidYMid meet">
      <defs>
        <radialGradient id="flareGrad" cx="50%" cy="50%">
          <stop offset="0%" stop-color="#fff" stop-opacity="0.95"/>
          <stop offset="20%" stop-color="#ffd89b" stop-opacity="0.55"/>
          <stop offset="40%" stop-color="#ff7a7a" stop-opacity="0.18"/>
          <stop offset="100%" stop-color="#000000" stop-opacity="0"/>
        </radialGradient>
      </defs>
      <circle cx="300" cy="200" r="120" fill="url(#flareGrad)"/>
      <circle cx="260" cy="220" r="36" fill="#fff" opacity="0.12"/>
      <ellipse cx="320" cy="210" rx="220" ry="26" fill="#ffd89b" opacity="0.03"/>
    </svg>
  </div>

  <!-- exhaust / spaceship -->
  <div id="spaceship" class="spaceship-container" role="img" aria-label="Spaceship">
    <div class="spaceship">
      <div class="antenna" style="position:absolute;left:50%;top:-10px;width:2px;height:18px;background:#9aa2a9;border-radius:2px;transform:translateX(-50%);z-index:6"></div>
      <div class="antenna-tip" style="position:absolute;left:50%;top:-20px;width:6px;height:6px;border-radius:50%;background:#ff6b6b;transform:translateX(-50%);z-index:7;box-shadow:0 0 8px rgba(255,107,107,0.7)"></div>
      <div class="nose-highlight"></div>
      <div class="nose-cone"></div>
      <div class="ship-body"></div>
      <div class="panel-1"></div>
      <div class="panel-2"></div>
      <div class="panel-3"></div>
      <div class="cockpit-frame"></div>
      <div class="cockpit"></div>
      <div class="fin-left"></div>
      <div class="fin-right"></div>
      <div class="fin-detail-left"></div>
      <div class="fin-detail-right"></div>
      <div class="engine-section"></div>
      <div class="engine-left"></div>
      <div class="engine-right"></div>

      <!-- soft DOM flames for shimmer that work with the canvas exhaust -->
      <div class="main-engine"></div>
      <div class="side-engine-left"></div>
      <div class="side-engine-right"></div>
      <!-- sparks container (dom) -->
      <div id="sparksContainer" style="position:absolute;left:0;right:0;top:0;bottom:0;pointer-events:none"></div>
    </div>
  </div>

  <div class="footer" id="footer">Powered by SquadVertex</div>

  <!-- SVG filter for heat distortion -->
  <svg width="0" height="0" style="position:absolute">
    <defs>
      <filter id="heat">
        <feTurbulence id="turb" baseFrequency="0.009" numOctaves="2" seed="2" result="turb"/>
        <feDisplacementMap in="SourceGraphic" in2="turb" scale="6" xChannelSelector="R" yChannelSelector="G"/>
      </filter>
    </defs>
  </svg>

<script>
/* ===============================
   Utilities + performance guards
   =============================== */
const clamp = (v,a,b)=>Math.max(a,Math.min(b,v));

/* ===============================
   Canvas starfield (fast, layered)
   =============================== */
const canvas = document.getElementById('canvasStars');
const ctx = canvas.getContext('2d');
let cw = canvas.width = innerWidth;
let ch = canvas.height = innerHeight;
const starLayers = [
  {count: 160, speed: 0.03, size: [0.4,1.2], alpha: [0.05,0.45]},
  {count: 90, speed: 0.09, size: [0.9,2.6], alpha: [0.15,0.9]},
  {count: 40, speed: 0.22, size: [1.6,3.6], alpha: [0.35,1]}
];

let stars = [];
function initStars(){
  stars = [];
  for(let li=0; li<starLayers.length; li++){
    const L = starLayers[li];
    for(let i=0;i<L.count;i++){
      stars.push({
        x: Math.random()*cw,
        y: Math.random()*ch,
        z: li, // layer index
        size: (Math.random()*(L.size[1]-L.size[0])+L.size[0]),
        alpha: (Math.random()*(L.alpha[1]-L.alpha[0])+L.alpha[0]),
        twinkleOffset: Math.random()*Math.PI*2,
        vx: (Math.random()-0.5)*0.12
      });
    }
  }
}
initStars();

let last = performance.now();
let pointer = {x: cw/2, y: ch/2};
window.addEventListener('resize', ()=>{cw = canvas.width = innerWidth; ch = canvas.height = innerHeight; initStars();});
window.addEventListener('mousemove', (e)=>{pointer.x=e.clientX;pointer.y=e.clientY});

/* starfield draw loop */
function drawStars(t){
  const now = t || performance.now();
  const dt = Math.min(40, now - last)/1000;
  last = now;
  ctx.clearRect(0,0,cw,ch);

  // slight parallax by pointer
  const px = (pointer.x - cw/2)/cw * 30;
  const py = (pointer.y - ch/2)/ch * 20;

  for(let s of stars){
    const L = starLayers[s.z];
    // twinkle
    const tw = 0.5 + 0.5*Math.sin((t/800)+s.twinkleOffset);
    const x = (s.x + px*(s.z+1)*0.06 + s.vx * (t/16)) % cw;
    const y = (s.y + py*(s.z+1)*0.03 + (s.z*0.2)) % ch;

    ctx.beginPath();
    // subtle radial star glow
    const grad = ctx.createRadialGradient(x,y,0,x,y,s.size*6);
    grad.addColorStop(0, `rgba(255,255,255,${s.alpha*tw})`);
    grad.addColorStop(0.4, `rgba(255,255,255,${s.alpha*tw*0.35})`);
    grad.addColorStop(1, 'rgba(255,255,255,0)');
    ctx.fillStyle = grad;
    ctx.arc(x,y,s.size,0,Math.PI*2);
    ctx.fill();
  }

  requestAnimationFrame(drawStars);
}
requestAnimationFrame(drawStars);

/* ===============================
   Exhaust particle system (canvas)
   efficient particle pool for realism
   =============================== */
const exhaustCanvas = document.getElementById('exhaustCanvas');
const exCtx = exhaustCanvas.getContext('2d');
exhaustCanvas.width = innerWidth;
exhaustCanvas.height = innerHeight;
window.addEventListener('resize', ()=>{exhaustCanvas.width=innerWidth; exhaustCanvas.height=innerHeight;});

const exhaustParticles = [];
const MAX_EXHAUST = 420; // pooled
for(let i=0;i<MAX_EXHAUST;i++){
  exhaustParticles.push({alive:false,x:0,y:0,vx:0,vy:0,life:0,maxLife:0,size:0,alpha:0,color:null});
}

/* spawn an exhaust particle near spaceship engines */
function spawnExhaust(x,y,force=1){
  // find free particle
  for(let p of exhaustParticles){
    if(!p.alive){
      p.alive = true;
      p.x = x + (Math.random()-0.5)*24;
      p.y = y + (Math.random()*6);
      const spread = 0.6 + Math.random()*1.8;
      p.vx = (Math.random()-0.5)*10*spread + (Math.random()>0.5? -3:3) * (force*0.2);
      p.vy = - (6 + Math.random()*14) * (1+force*0.6);
      p.life = 0; p.maxLife = 300 + Math.random()*700;
      p.size = (2 + Math.random()*5) * (1+force*0.6);
      p.alpha = 0.85 + Math.random()*0.2;
      // color gradient between bright core and orange
      const r = 220 + Math.floor(Math.random()*35);
      p.color = `rgba(${r},${80+Math.floor(Math.random()*80)},${20},${p.alpha})`;
      break;
    }
  }
}

/* exhaust update/draw */
function updateExhaust(dt){
  exCtx.clearRect(0,0,exhaustCanvas.width,exhaustCanvas.height);
  // warp field behind ship to create sense of heat
  for(let p of exhaustParticles){
    if(!p.alive) continue;
    p.life += dt;
    if(p.life > p.maxLife){ p.alive=false; continue; }
    // physics, lighter as life increases
    p.vy += 0.02 * (p.life/p.maxLife);
    p.vx *= 0.998;
    p.x += p.vx * (dt*0.06);
    p.y += p.vy * (dt*0.06);
    const t = p.life / p.maxLife;
    const size = p.size * (1 + t*2.5);
    const alpha = p.alpha * (1 - t);
    // draw radial gradient with larger blur to simulate bloom
    const g = exCtx.createRadialGradient(p.x, p.y, 0, p.x, p.y, size*6);
    g.addColorStop(0, `rgba(255,255,255,${alpha*0.9})`);
    g.addColorStop(0.2, p.color.replace(/,\d+(\.\d+)?\)$/, `,${alpha*0.75})`));
    g.addColorStop(0.6, 'rgba(255,120,50,0.08)');
    g.addColorStop(1, 'rgba(0,0,0,0)');
    exCtx.globalCompositeOperation = 'lighter';
    exCtx.fillStyle = g;
    exCtx.beginPath();
    exCtx.arc(p.x,p.y,size,0,Math.PI*2);
    exCtx.fill();
    // add faint elongated trail
    exCtx.globalCompositeOperation = 'destination-over';
    exCtx.fillStyle = `rgba(255,150,50,${alpha*0.03})`;
    exCtx.fillRect(p.x-1, p.y, 2, size*12 * (1-t));
  }
}

/* loop for exhaust using RAF for high frequency */
let lastEx = performance.now();
function exhaustLoop(ts){
  const now = ts || performance.now();
  const dt = now - lastEx;
  lastEx = now;
  // spawn a few particles per frame when engines are active (we toggle from JS during ignition)
  if(window.__enginesOn){
    // spawn near bottom center of spaceship (approx relative to viewport)
    const shipRect = document.getElementById('spaceship').getBoundingClientRect();
    // spawn at three nozzle positions
    spawnExhaust(shipRect.left + shipRect.width*0.5, shipRect.top + shipRect.height*0.87, window.__enginePower||1);
    spawnExhaust(shipRect.left + shipRect.width*0.28, shipRect.top + shipRect.height*0.87, (window.__enginePower||1)*0.6);
    spawnExhaust(shipRect.left + shipRect.width*0.72, shipRect.top + shipRect.height*0.87, (window.__enginePower||1)*0.6);
  }
  updateExhaust(dt);
  requestAnimationFrame(exhaustLoop);
}
requestAnimationFrame(exhaustLoop);

/* ===============================
   Micro DOM sparks and glow
   =============================== */
const sparksContainer = document.getElementById('sparksContainer');
function spawnSpark(x,y){
  const el = document.createElement('div');
  el.className='spark';
  el.style.left = `${x}px`; el.style.top=`${y}px`;
  sparksContainer.appendChild(el);
  // animate via anime.js then remove
  anime({
    targets: el,
    translateX: ()=> (Math.random()-0.5)*60,
    translateY: ()=> - (30 + Math.random()*80),
    opacity: [1,0],
    scale: [1, 0.2],
    duration: 700 + Math.random()*600,
    easing: 'easeOutCubic',
    complete: ()=> el.remove()
  });
}

/* ===============================
   Mouse parallax for nebula + lens flare + ship
   =============================== */
const lens = document.querySelector('.lensflare');
const nebulaEl = document.querySelector('.nebula');
const shipContainer = document.getElementById('spaceship');
document.addEventListener('mousemove', (e)=>{
  const cx = e.clientX / innerWidth - 0.5;
  const cy = e.clientY / innerHeight - 0.5;
  // small transforms
  lens.style.transform = `translateX(calc(-50% + ${cx*24}px)) translateY(${cy*12}px)`;
  nebulaEl.style.transform = `translateX(${cx*8}px) translateY(${cy*6}px) scale(1.02)`;
  shipContainer.style.transform = `translateX(calc(-50% + ${cx*6}px)) translateY(${cy*6}px)`;
});

/* ===============================
   UI: progress bar + auto countdown
   =============================== */
const progressBar = document.getElementById('progressBar');
anime({targets:progressBar,width:['0%','100%'],duration:5200,easing:'linear'});

let countdownValue = 5;
const countdownEl = document.getElementById('countdown');
const countdownInterval = setInterval(()=>{
  countdownValue--;
  countdownEl.textContent = `AUTO-LAUNCH IN: ${countdownValue}`;
  if(countdownValue<=0){
    clearInterval(countdownInterval);
    triggerLaunch();
  }
},1000);

/* ===============================
   Launch choreography (anime.js + JS-driven visuals)
   - ignition pulses
   - heat distortion applied via filter scaling
   - camera shake
   - background fades & redirect
   =============================== */
let isLaunching = false;
const footer = document.getElementById('footer');
const mainEngineEl = document.querySelector('.main-engine');
const sideEngines = document.querySelectorAll('.side-engine-left, .side-engine-right');
const contentEl = document.getElementById('content');
const nebulaLayer = document.querySelector('.nebula');

function playIgnitionSequence(){
  // glow pulse for cockpit + nose
  anime({
    targets: ['.cockpit','.nose-highlight'],
    scale: [1,1.06,1],
    duration: 900,
    easing: 'easeInOutSine',
    loop: 3
  });

  // short bursts of sparks
  const shipRect = shipContainer.getBoundingClientRect();
  for(let i=0;i<6;i++){
    setTimeout(()=>spawnSpark(shipRect.left + shipRect.width*0.5 + (Math.random()-0.5)*30, shipRect.top + shipRect.height*0.9), i*110);
  }

  // breathing side-engine flicker (animating DOM flames)
  anime({
    targets: mainEngineEl,
    opacity: [0,1],
    scale: [0.9,1],
    duration: 250,
    easing: 'easeOutQuad',
    complete: ()=>{
      // loop the subtle oscillation
      anime({
        targets: mainEngineEl,
        scale: [1,1.08],
        duration: 400,
        direction: 'alternate',
        easing: 'easeInOutSine',
        loop: true
      });
    }
  });
  anime({
    targets: sideEngines,
    opacity: [0,1],
    duration: 350,
    delay: anime.stagger(60),
    loop: true,
    direction: 'alternate',
    easing: 'easeInOutSine'
  });

  // mark engines on so exhaust loop spawns
  window.__enginesOn = true; window.__enginePower = 0.8;
  // ramp engine power up over time while we lift
  anime({
    targets: window,
    __enginePower: [0.8, 1.6],
    duration: 2600,
    easing: 'easeOutCubic',
    update: function(anim){
      // use property to mod how many particles spawn or their vigor
    }
  });
}

/* simple camera shake helper using Anime on body transform */
function cameraShake(intensity=1.0, duration=600){
  anime({
    targets: document.body,
    translateX: [0, -6*intensity, 6*intensity, -3*intensity, 3*intensity, 0],
    translateY: [0, -3*intensity, 3*intensity, -1*intensity, 1*intensity, 0],
    duration: duration,
    easing: 'easeInOutQuad'
  });
}

/* apply heat filter (animate the displacement scale by adjusting feTurbulence baseFrequency via attr) */
const turb = document.getElementById('turb');
function animateHeat(on){
  if(on){
    // ramp turbulence frequency up
    let seed = 1;
    const t = setInterval(()=>{
      // tweak baseFrequency randomly for organic effect
      const bf = 0.006 + Math.random()*0.018;
      turb.setAttribute('baseFrequency', bf.toFixed(4));
      seed++;
      if(!window.__enginesOn) { clearInterval(t); turb.setAttribute('baseFrequency', '0.009'); }
    }, 80);
  } else {
    turb.setAttribute('baseFrequency','0.009');
  }
}

/* main launch caller (called by button or auto) */
function triggerLaunch(){
  if(isLaunching) return;
  isLaunching = true;
  clearInterval(countdownInterval);
  document.getElementById('enterBtn').style.display='none';
  countdownEl.style.display='none';

  // show spaceship
  anime({targets:'#spaceship',opacity:[0,1],duration:460,easing:'easeOutQuad'});

  // ignition
  setTimeout(()=>{ playIgnitionSequence(); animateHeat(true); cameraShake(1.1,700); }, 220);

  // ramp engine visuals and lift-off sequence
  setTimeout(()=>{
    // full thrust visuals
    window.__enginePower = 2.2;
    // heavy sparks burst
    const shipRect = shipContainer.getBoundingClientRect();
    for(let i=0;i<18;i++){
      setTimeout(()=>spawnSpark(shipRect.left + shipRect.width*0.5 + (Math.random()-0.5)*60, shipRect.top + shipRect.height*0.9), i*40);
    }
    cameraShake(1.6,900);

    // animate DOM flames big and bright
    anime({
      targets: mainEngineEl,
      opacity: [1,0.85,1],
      scale: [1.08,1.35],
      duration: 480,
      easing: 'easeOutSine',
      direction: 'alternate',
      loop: 8
    });
    anime({
      targets: ['.side-engine-left','.side-engine-right'],
      opacity: [1,0.9,1],
      scale: [1.05,1.4],
      duration: 420,
      delay: anime.stagger(60),
      easing:'easeOutSine',
      loop:8
    });

    // push content & backgrounds to fade and ship to climb
    anime({
      targets: [contentEl, document.querySelector('.nebula'), document.getElementById('canvasStars')],
      opacity: [1,0],
      duration: 1200,
      easing: 'easeInOutQuad',
    });

    // actual liftoff: move spaceship bottom off-screen with motion blur trail effect
    anime({
      targets: '#spaceship',
      bottom: ['-260px','120vh'],
      translateY: [0, -80],
      duration: 2600,
      easing: 'cubicBezier(0.22,1,0.35,1)',
      begin: function(){
        // create trailing blurred clones to simulate fast motion (quick DOM "ghosts")
        const trail = document.createElement('div');
        trail.className='trail';
        trail.style.width = `${document.querySelector('.spaceship').offsetWidth}px`;
        trail.style.height = `${document.querySelector('.spaceship').offsetHeight}px`;
        trail.style.left = `${(innerWidth/2) - (document.querySelector('.spaceship').offsetWidth/2)}px`;
        trail.style.top = `${innerHeight - 200}px`;
        trail.style.background = 'radial-gradient(circle, rgba(255,255,255,0.02), rgba(0,0,0,0))';
        trail.style.borderRadius='12px';
        trail.style.zIndex = 17;
        document.body.appendChild(trail);
        anime({targets:trail, translateY: -480, opacity:[0.12,0], duration:2400, easing:'easeOutCubic', complete: ()=>trail.remove()});
      },
      complete: function(){
        // stop engines spawning
        window.__enginesOn = false;
        animateHeat(false);
        // show footer then redirect (keeps UX)
        footer.classList.add('show');
        setTimeout(()=>{ window.location.href = '/teamgalaxy/dashboard'; }, 900);
      }
    });

  }, 700);
}

/* button handler */
document.getElementById('enterBtn').addEventListener('click', ()=>triggerLaunch());

/* small interactive particle push on mousemove for depth */
const particlesLayer = document.getElementById('particles');
const microParticles = [];
for(let i=0;i<26;i++){
  const el = document.createElement('div');
  el.style.position='absolute'; el.style.width='4px'; el.style.height='4px'; el.style.borderRadius='50%';
  el.style.left = Math.random()*100+'%'; el.style.top = Math.random()*100+'%';
  el.style.opacity = (Math.random()*0.5+0.08).toString();
  el.style.background = `rgba(255,255,255,${Math.random()*0.6+0.08})`;
  el.style.transform = `translate3d(0,0,0)`;
  el.style.willChange = 'transform,opacity';
  particlesLayer.appendChild(el);
  microParticles.push(el);
}
let lastMove = 0;
document.addEventListener('mousemove', (e)=>{
  const now=Date.now();
  if(now-lastMove < 14) return; lastMove=now;
  const cx = (e.clientX/innerWidth-0.5); const cy = (e.clientY/innerHeight-0.5);
  microParticles.forEach((p,idx)=>{
    const tx = cx*(idx%5+0.8)*12; const ty = cy*(idx%7+0.8)*10;
    anime({
      targets:p,
      translateX: tx,
      translateY: ty,
      duration: 700 + (idx*20),
      easing:'easeOutQuad'
    });
  });
});

/* safe page unload cleanup */
window.addEventListener('beforeunload', ()=>{ window.__enginesOn = false; });

/* start button auto hint: gentle entrance */
anime({targets:'.logo',translateY:[18,0],opacity:[0,1],duration:900,easing:'easeOutCubic',delay:120});
anime({targets:'.tagline',translateY:[22,0],opacity:[0,1],duration:900,easing:'easeOutCubic',delay:260});

/* exhaust runner: spawn rate controlled in exhaustLoop via window.__enginesOn variable */
/* we already started the exhaust loop above */

/* attach a small keyboard shortcut for demo: press Space to launch */
window.addEventListener('keydown',(e)=>{ if(e.code==='Space'){ e.preventDefault(); triggerLaunch(); }});
</script>
</body>
</html>