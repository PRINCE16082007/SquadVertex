<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Galaxy Portfolio</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
  <style>
    html, body { padding: 0; margin: 0; background: #181f2b; color: #fff; font-family: Arial, sans-serif; min-height: 100%; width: 100%; }
    body { box-sizing: border-box; }

    /* Header/footer - original provided code */
    .top-bar { display: flex; align-items: center; justify-content: space-between; height: 90px; background: rgba(16,23,36,0.85); padding: 0 40px; backdrop-filter: blur(10px); border-bottom: 1px solid rgba(255,255,255,0.1); position: sticky; top: 0; z-index: 100; }
    .logo-title { display: flex; align-items: center; gap: 15px; font-size: 1.8rem; font-weight: bold; font-family: 'Montserrat',sans-serif; color: #fff; }
    .logo-title img { height: 90px; filter: drop-shadow(0 0 8px rgba(97,218,251,0.7)); }
    .nav-buttons { display: flex; align-items: center; gap: 30px; font-size: 1.1rem; position: relative;}
    .nav-btn, .profile-btn { background: none; border: none; color: #e0e0e0; cursor: pointer; font-size: 1rem; position: relative; font-family: 'Poppins',sans-serif; font-weight: 500; padding: 8px 12px; border-radius: 6px; transition: all 0.3s;}
    .nav-btn:hover, .profile-btn:hover { color: #64c2ff; background: rgba(255,255,255,0.05);}
    .profile-btn img { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; border: 2px solid #64c2ff;}
    .dropdown-content { display: none; position: absolute; right: 0; background: rgba(29,35,54,0.95); min-width: 160px; border-radius: 8px; box-shadow: 0 8px 24px rgba(0,0,0,0.2); top: 50px; z-index: 1000; backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); overflow: hidden;}
    .dropdown-content a { color: #e0e0e0; padding: 12px 16px; text-decoration: none; display: block; border-bottom: 1px solid rgba(255,255,255,0.05); transition: all 0.2s;}
    .dropdown-content a:last-child { border-bottom: none; }
    .dropdown-content a:hover { background: rgba(100,194,255,0.1); color: #64c2ff;}
    .nav-buttons .more-options:hover .dropdown-content,
    .nav-buttons .profile-btn.show-menu + .dropdown-content { display: block; }

    /* Banner image */
    .banner-img-section {
      width: 100%; height: 400px; background: #23263a;
      display: flex; align-items: flex-end; justify-content: flex-start;
      position: relative; overflow: hidden; z-index: 2;
    }
    .banner-img-section img {
      width: 100%; height: 100%; object-fit: cover; display: block;
      border-bottom: 2px solid rgba(255,255,255,0.07);
    }

    .portfolio-section {
      max-width: 1240px;
      margin: 0 auto;
      padding: 54px 20px 64px 20px;
      min-height: 480px;
    }
    .portfolio-title {
      font-size: 2.2rem;
      color: #fab84f;
      font-weight: bold;
      margin-bottom: 28px;
      letter-spacing: 2px;
      text-shadow: 0 5px 30px #20294061;
    }
    .categories-grid {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 44px 36px;
      margin-top: 38px;
      margin-bottom: 68px;
    }
    .category-card {
      background: #161c2b;
      border-radius: 16px;
      box-shadow: 0 6px 28px #22284c99;
      overflow: hidden;
      position: relative;
      cursor: pointer;
      transition: box-shadow 0.25s, transform 0.13s;
      min-height: 208px;
      display: flex; flex-direction: column; justify-content: stretch;
      align-items: stretch;
    }
    .category-card:hover { box-shadow:0 10px 38px #27315f; transform:scale(1.03);}
    .category-card img {
      width: 100%; height: 168px; object-fit: cover; display: block;
      border-bottom: 1px solid #23294044;
      transition: filter 0.22s, opacity 0.16s;
    }
    .category-card .cat-label {
      padding: 14px 22px; font-size: 1.25rem; font-weight: 700;
      color: #fab84f;
      font-family: 'Montserrat',sans-serif;
      letter-spacing: 1.2px; text-align: left;
      background: none;
      text-shadow: 0 2px 18px #191c21cc;
    }

    /* Modal styles */
    .modal-bg {
      position: fixed; left: 0; top: 0; width: 100vw; height: 100vh;
      background: rgba(28, 33, 49, 0.96); z-index: 99;
      display: flex; align-items: center; justify-content: center;
      animation: fadeInModal 0.22s;
    }
    @keyframes fadeInModal {
      from { opacity: 0; } to { opacity: 1;}
    }
    .modal-gallery {
      background: #191e2a;
      border-radius: 24px;
      padding: 42px 38px;
      min-width: 320px; max-width: 840px;
      max-height: 86vh; overflow-y: auto;
      box-shadow: 0 6px 40px #191e2a99;
      position: relative;
      display: flex; flex-direction: column; align-items: center;
      gap: 26px;
    }
    .modal-gallery-title { font-size: 1.65rem; color: #fab84f; font-weight: 700; margin-bottom: 20px; text-align: center;}
    .modal-gallery-images {
      display: flex; flex-wrap: wrap; gap: 24px; justify-content: center; align-items: flex-start;
    }
    .modal-gallery-images img {
      max-width: 250px; max-height: 170px; border-radius: 10px;
      box-shadow: 0 4px 18px #212e40b5;
      background: #20282e;
      margin-bottom: 7px; object-fit: cover;
      transition: transform 0.21s;
      cursor: pointer;
    }
    .modal-gallery-images img:hover { transform: scale(1.06);}
    .modal-close-btn {
      position: absolute; top: 24px; right: 26px;
      font-size: 2.28rem; color: #ddd; background: none; border: none;
      cursor: pointer; transition: color 0.2s;
    }
    .modal-close-btn:hover { color: #fab84f;}
    .modal-category-switch {
      width: 100%; display: flex; justify-content: space-between; margin-bottom: 18px;
      gap: 24px;
    }
    .modal-switch-btn {
      padding: 8px 22px; background: #fab84f; color: #23263a;
      font-weight: 700; font-size: 1.06rem; border: none; border-radius: 8px;
      cursor: pointer; transition: background 0.23s;
    }
    .modal-switch-btn:hover { background: #64c2ff; color: #fff;}
    @media (max-width:1050px){ .categories-grid{grid-template-columns:1fr 1fr;} }
    @media (max-width:700px){ .categories-grid{grid-template-columns:1fr;} .portfolio-section{padding:34px 2vw 44px 2vw;} }
    @media (max-width:600px){ .modal-gallery{max-width:98vw;padding:12px 4vw;}.modal-gallery-images img{max-width:90vw;} }
    /* Footer, unchanged */
    .footer { min-height: 320px; background: linear-gradient(90deg, #131825 0%, #1a2232 50%, #20293d 100%); color: #fff; display: grid; grid-template-columns: 1fr 1fr; gap: 40px; align-items: start; padding: 50px; border-top: 1px solid rgba(255,255,255,0.05); box-sizing: border-box;}
    .footer-col { padding: 0 15px; display: flex; flex-direction: column; height: 100%; }
    .footer-about-title { font-size: 1.5rem; font-weight: 700; margin-bottom: 15px; color: #fab84f; font-family: 'Montserrat',sans-serif; }
    .footer-about-text { font-size: 1rem; color: #d0d0d0; margin-bottom: 20px; line-height: 1.6;}
    .footer-social { margin-top: auto; display: flex; gap: 18px; }
    .footer-social a { color: #aaa; font-size: 1.8rem; text-decoration: none; transition: all 0.3s;}
    .footer-social a:hover { color: #64c2ff; transform: translateY(-3px);}
    .footer-links-col { display: flex; flex-direction: column;}
    .footer-links-col a { font-size: 1.1rem; color: #d0d0d0; text-decoration: none; margin-bottom: 14px; font-weight: 500; transition: all 0.2s ease; display: block;}
    .footer-links-col a:hover { color: #fab84f; transform: translateX(5px);}
    .address-section { margin-top: 20px; padding: 20px; background: rgba(255,255,255,0.05); border-radius: 8px;}
    .address-title { font-size: 1.2rem; color: #fab84f; margin-bottom: 10px; font-weight: 600;}
    .address-text { font-size: 1rem; color: #d0d0d0; line-height: 1.6;}
    @media(max-width:900px){ .footer{grid-template-columns:1fr;gap:20px;padding:24px;} }
  </style>
</head>
<body>
<!-- HEADER -->
<div class="top-bar">
  <div class="logo-title">
    <img src="https://dl.dropboxusercontent.com/scl/fi/ulfs6ygkeyvr4mar8bkuz/galaxwbewh.png?rlkey=jq9buj80ny6et6jfbfpiuf14l&st=lwkqobqi&dl=0" height="46" alt="Logo" />
    GalaxyWeb
  </div>
  <div class="nav-buttons">
    <button class="nav-btn">Home</button>
    <button class="nav-btn">Team Galaxy</button>
    <div class="more-options">
      <button class="nav-btn">More ▼</button>
      <div class="dropdown-content">
        <a href="#">Blog</a>
        <a href="#">Posts</a>
        <a href="#">Portfolio</a>
      </div>
    </div>
    <button id="profileBtn" class="profile-btn"><i class="fa-solid fa-user"></i></button>
    <div id="profileMenu" class="dropdown-content" style="right: 30px; display:none;">
      <a href="#" id="profileLink">Profile</a>
      <a href="#" id="logoutLink">Logout</a>
    </div>
  </div>
</div>
<script>
  const profileBtn = document.getElementById("profileBtn");
  const profileMenu = document.getElementById("profileMenu");
  profileBtn.addEventListener("click", (e) => { e.stopPropagation(); profileMenu.style.display = profileMenu.style.display === "block" ? "none" : "block"; });
  window.addEventListener("click", () => { profileMenu.style.display = "none"; });
</script>

<!-- Banner -->
<section class="banner-img-section">
  <img src="https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=1200&q=80" alt="Banner" />
</section>

<main>
  <div class="portfolio-section">
    <div class="portfolio-title">Portfolio Gallery</div>
    <div class="categories-grid" id="portfolioCategories"></div>
  </div>
</main>

<!-- Modal for viewing images in category -->
<div id="portfolioModal" style="display:none;"></div>

<!-- FOOTER -->
<footer class="footer">
  <div class="footer-col">
    <div class="footer-about-title">About TeamGalaxy</div>
    <div class="footer-about-text">
      TeamGalaxy is an innovative gaming and creative community, united by passion and the spirit of collaboration. 
      We host tournaments, share design ideas, and grow talents together — join now to explore the Galaxy!
    </div>
    <div class="footer-social">
      <a href="https://twitter.com" title="Twitter"><i class="fab fa-twitter"></i></a>
      <a href="https://facebook.com" title="Facebook"><i class="fab fa-facebook"></i></a>
      <a href="https://instagram.com" title="Instagram"><i class="fab fa-instagram"></i></a>
      <a href="https://youtube.com" title="YouTube"><i class="fab fa-youtube"></i></a>
      <a href="https://discord.com" title="Discord"><i class="fab fa-discord"></i></a>
    </div>
  </div>
  <div class="footer-col">
    <div class="footer-links-col">
      <a href="#">Privacy Policy</a>
      <a href="#">Terms & Conditions</a>
      <a href="#">Other</a>
    </div>
    <div class="address-section">
      <div class="address-title">Our Address</div>
      <div class="address-text">
        44 Galaxy St, Universe City, WebLand<br>
        Phone: +91-9876543210<br>
        Email: support@gmail.com<br>
        Working Hours: Mon-Sat 10am - 10pm
      </div>
    </div>
  </div>
</footer>

<!-- Firebase SDKs + AppCheck + Portfolio JS -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-check-compat.js"></script>
<script src="https://www.google.com/recaptcha/api.js?render=6Ld395IrAAAAAIvG4gyf0vUJeI_jKOsI9XVn0jUx"></script>
<script>
  // Firebase & AppCheck
  const firebaseConfig = {
    apiKey: "AIzaSyBV7Jg0BVzeCNQW9oiIiNItnejUsjj2DhA",
    authDomain: "squadvertex2007.firebaseapp.com",
    projectId: "squadvertex2007",
    storageBucket: "squadvertex2007.appspot.com",
    messagingSenderId: "168905083514",
    appId: "1:168905083514:web:c8bbe2ce9f87800a0f09c3"
  };
  firebase.initializeApp(firebaseConfig);
  try {
    const appCheckProvider = new firebase.appCheck.ReCaptchaV3Provider('6Ld395IrAAAAAIvG4gyf0vUJeI_jKOsI9XVn0jUx');
    firebase.appCheck().activate(appCheckProvider, true);
  } catch (e) { console.warn('App Check activation failed:', e);}
  const db = firebase.firestore();

  // Load categories (documents in portfolio), get cover image from their "images" subcollection
  let categoryDocs = [];   // Array of category {id, name}
  let categoriesFetchedImages = {}; // cache {catIdx: [urls]}
  async function loadCategories() {
    const grid = document.getElementById("portfolioCategories");
    grid.innerHTML = "...";
    const snap = await db.collection("portfolio").get();
    categoryDocs = [];
    categoriesFetchedImages = {};
    let promises = [];
    snap.docs.forEach((doc, idx) => {
      const docId = doc.id;
      categoryDocs.push({ id: docId, name: docId }); // name field can be customized
      // Get first image url as cover preview
      const p = db.collection("portfolio").doc(docId).collection("images").limit(1).get().then(subsnap => {
        let url = subsnap.docs.length ? subsnap.docs[0].data().url : "";
        const div = document.createElement("div");
        div.className = "category-card";
        div.onclick = () => openModal(idx);
        const img = document.createElement("img");
        img.src = url || "https://dummyimage.com/500x300/181f2b/767676.png&text=No+Preview";
        img.alt = docId;
        div.appendChild(img);
        let lbl = document.createElement("div");
        lbl.className = "cat-label"; lbl.textContent = docId;
        div.appendChild(lbl);
        grid.appendChild(div);
      });
      promises.push(p);
    });
    await Promise.all(promises);
  }

  // Modal logic
  function openModal(catIdx) {
    let modal = document.getElementById("portfolioModal");
    modal.style.display = "flex";
    // Load images for this category if not loaded
    if (!categoriesFetchedImages[catIdx]) {
      db.collection("portfolio").doc(categoryDocs[catIdx].id).collection("images").get().then(snap => {
        categoriesFetchedImages[catIdx] = snap.docs.map(doc => doc.data().url);
        showModalContent(catIdx);
      });
    } else {
      showModalContent(catIdx);
    }
  }
  function showModalContent(catIdx) {
    let modal = document.getElementById("portfolioModal");
    let images = categoriesFetchedImages[catIdx];
    let name = categoryDocs[catIdx].name;
    let categoriesNum = categoryDocs.length;
    let prevBtn = catIdx>0? `<button class="modal-switch-btn" onclick="showModalContent(${catIdx-1})">← Previous</button>` : '';
    let nextBtn = catIdx<categoriesNum-1? `<button class="modal-switch-btn" onclick="showModalContent(${catIdx+1})">Next →</button>` : '';
    modal.innerHTML = `
      <div class="modal-bg" onclick="closeModal(event)">
        <div class="modal-gallery" onclick="event.stopPropagation()">
          <button class="modal-close-btn" onclick="closeModal(event)">&times;</button>
          <div class="modal-category-switch">
            ${prevBtn}
            ${nextBtn}
          </div>
          <div class="modal-gallery-title">${name}</div>
          <div class="modal-gallery-images">
            ${(images&&images.length)?images.map(url=>`<img src="${url}" alt="">`).join(""):'<div style="color:#d6e4ff;">No images in this category.</div>'}
          </div>
        </div>
      </div>
    `;
  }
  function closeModal(e){ 
    let modal = document.getElementById("portfolioModal");
    modal.style.display = "none";
    modal.innerHTML = '';
  }
  window.onload = loadCategories;
</script>
</body>
</html>
