<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SquadVertex Voting</title>
  <script type="module">
    // Firebase initialization
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.2/firebase-app.js";
    import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/9.17.2/firebase-firestore.js";

    const firebaseConfig = {
     apiKey: "AIzaSyBV7Jg0BVzeCNQW9oiIiNItnejUsjj2DhA",
      authDomain: "squadvertex2007.firebaseapp.com",
      databaseURL: "https://squadvertex2007-default-rtdb.firebaseio.com/",
      projectId: "squadvertex2007",
      storageBucket: "squadvertex2007.firebasestorage.app",
      messagingSenderId: "168905083514",
      appId: "1:168905083514:web:c8bbe2ce9f87800a0f09c3",
};

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Check if user already voted
    function hasVoted() {
      return localStorage.getItem("voted") === "true";
    }

    // Mark user as voted
    function markAsVoted() {
      localStorage.setItem("voted", "true");
    }

    // Submit vote
    async function submitVote(voteOption) {
      if (hasVoted()) {
        alert("You have already voted!");
        return;
      }

      // Generate a random unique ID for this user (UUID or similar)
      const userId = localStorage.getItem("userId") || `user_${Date.now()}`;
      localStorage.setItem("userId", userId);

      const docRef = doc(db, "votes", userId);
      const docSnap = await getDoc(docRef);

      if (docSnap.exists()) {
        alert("You have already voted!");
      } else {
        await setDoc(docRef, { voteOption: voteOption, timestamp: new Date() });
        markAsVoted();
        alert("Vote submitted successfully!");
      }
    }
  </script>
</head>
<body>
  <h1>Vote for Your Favorite Option</h1>
  <div>
    <button onclick="submitVote('Option A')">Vote for Option A</button>
    <button onclick="submitVote('Option B')">Vote for Option B</button>
    <button onclick="submitVote('Option C')">Vote for Option C</button>
  </div>
</body>
</html>